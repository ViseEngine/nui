{"version":3,"sources":["demo-debug.js"],"names":["Nui","define","component","template","events","statics","_paths","_init","self","this","doc","on","back","forward","_setpaths","rule","paths","_replace","hash","replace","location","protocol","host","_getWrapper","container","$","appendTo","_split","url","ret","params","match","split","each","v","k","arr","_change","isEmptyObject","_hash","query","path","indexOf","object","__instances","id","opts","options","param","length","val","key","_send","data","onData","call","isReceiveData","onChange","_isRrender","_wrapper","wrapper","destroy","off","element","tmpl","html","render","layout","onInit","init","show","siblings","hide","onAfter","_initialize","bsie7","_setHistory","_isEntry","entry","target","_render","eq","_oldhash","_bindHashchange","hashchange","setInterval","win","_$ready","_$fn","start","arguments","temp","_router","index","history","_history","_isHistory","active","push","value","len","i","window","extend","static","level","onBefore","router","constructor","_exec","_bind","_jquery","_getpath","sub","shift","join","_getTarget","_event","__id","substr","href","jQuery","attr","trigger","change","_on","e","elem","_reset","_off","option","reset"],"mappings":"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","file":"demo-min.js.map?v=0883658","sourcesContent":["/**\r\n * @author Aniu[2017-02-27 23:46]\r\n * @update Aniu[2017-02-27 23:46]\r\n * @version 1.0.1\r\n * @description 路由\r\n */\r\n\r\nNui.define('src/components/router',['component', 'template', 'events'], function(component, template, events){\r\n    var statics = {\r\n        _paths:{},\r\n        _init:function(){\r\n            var self = this;\r\n            Nui.doc.on('click', '.nui-router-back', function(){\r\n                return self.back()\r\n            }).on('click', '.nui-router-forward', function(){\r\n                return self.forward()\r\n            })\r\n        },\r\n        _setpaths:function(rule, paths){\r\n            if(!this._paths[rule]){\r\n                this._paths[rule] = paths\r\n            }\r\n        },\r\n        _replace:function(hash){\r\n                        //IE8-中 A标签href属性会被添加上域名，将其移除\r\n            return hash.replace(location.protocol+'//'+location.host, '')\r\n                        //移除空白\r\n                       .replace(/\\s+/g, '')\r\n                       //移除 #!前缀\r\n                       .replace(/^\\#\\!?/, '')\r\n                       //开头添加斜杠\r\n                       .replace(/^([^\\/])/, '/$1')\r\n                       //移除末尾斜杠\r\n                       .replace(/\\/$/, '');\r\n        },\r\n        _getWrapper:function(container){\r\n            return $('<div class=\"nui-router-wrapper\"></div>').appendTo(container)\r\n        },\r\n        _split:function(url){\r\n            var ret = {\r\n                url:url,\r\n                params:{}\r\n            }\r\n            var match = url.match(/\\?[^\\/\\s]+/);\r\n            if(match){\r\n                var params = match[0];\r\n                ret.url = url.replace(params, '');\r\n                params = params.replace('?', '').split('&');\r\n                Nui.each(params, function(v, k){\r\n                    var arr = v.split('=');\r\n                    ret.params[arr[0]] = arr[1]\r\n                })\r\n            }\r\n            return ret;\r\n        },\r\n        _change:function(){\r\n            var self = this;\r\n            if(!$.isEmptyObject(self._paths)){\r\n                var _hash = location.hash, ret = this._split(_hash), hash = self._replace(ret.url), query = ret.params;\r\n                Nui.each(self._paths, function(v){\r\n                    if(hash === v.path || hash.indexOf(v.path) === 0){\r\n                        var params = hash.replace(v.path, '').replace(/^\\//, '');\r\n                        var object = self.__instances[v.id], opts = object.options, param = {};\r\n                        params = params ? params.split('/') : [];\r\n                        if(params.length === v.params.length){\r\n                            Nui.each(v.params, function(val, key){\r\n                                param[val] = params[key]\r\n                            })\r\n\r\n                            Nui.each(query, function(val, key){\r\n                                param[val] = query[key]\r\n                            })\r\n\r\n                            if(object._send && object._send.data && typeof opts.onData === 'function'){\r\n                                opts.onData.call(opts, object._send.data);\r\n                                opts.isReceiveData = true;\r\n                                delete object._send;\r\n                            }\r\n\r\n                            opts.data.path = v.path+'/';\r\n                            opts.data.url = hash+'/';\r\n                            opts.data.params = param;\r\n                            opts.data.query = query;\r\n\r\n                            if(typeof opts.onChange === 'function'){\r\n                                opts.onChange.call(opts);\r\n                            }\r\n\r\n                            if(object._isRrender === true || !object._wrapper){\r\n                                if(opts.wrapper && !object._wrapper){\r\n                                    object._wrapper = self._getWrapper(object.container)\r\n                                }\r\n                                else if(!self._wrapper){\r\n                                    self._wrapper = self._getWrapper(object.container)\r\n                                }\r\n                                if(object._isRrender || !object._wrapper){\r\n                                    component.destroy((object._wrapper||self._wrapper).off());\r\n                                }\r\n                                var wrapper = opts.element = object._wrapper || self._wrapper;\r\n                                var tmpl = opts.template;\r\n                                \r\n                                if(tmpl){\r\n                                    if(typeof tmpl === 'string'){\r\n                                        wrapper.html(template.render(tmpl, opts.data));\r\n                                    }\r\n                                    else{\r\n                                        wrapper.html(template.render.call(tmpl, tmpl.layout, opts.data));\r\n                                    }\r\n                                }\r\n                                if(typeof opts.onInit === 'function'){\r\n                                    opts.onInit.call(opts);\r\n                                }\r\n                                events.call(opts);\r\n                                component.init(wrapper);\r\n                                delete object._isRrender;\r\n                            }\r\n                            var wrapper = object._wrapper || self._wrapper;\r\n                            wrapper.show().siblings('.nui-router-wrapper').hide();\r\n                            if(typeof opts.onAfter === 'function'){\r\n                                opts.onAfter.call(opts)\r\n                            }\r\n                            delete opts.isReceiveData;\r\n                            self._initialize = match = true;\r\n                            if(Nui.bsie7){\r\n                                self._setHistory(_hash);\r\n                            }\r\n                            return false\r\n                        }\r\n                    }\r\n                })\r\n\r\n                if(!self._initialize){\r\n                    Nui.each(self.__instances, function(v){\r\n                        if(!self._isEntry && v.options.entry === true){\r\n                            self._isEntry= true;\r\n                            if(v.target){\r\n                                v._render(v.target.eq(0));\r\n                            }\r\n                            self._initialize = true;\r\n                            return false\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n            self._oldhash = _hash;\r\n        },\r\n        _bindHashchange:function(){\r\n            var self = this;\r\n            if(Nui.bsie7){\r\n                var hashchange = function(ret){\r\n                    var hash = location.hash;\r\n                    if(self._oldhash !== hash){\r\n                        return !ret\r\n                    }\r\n                    return false\r\n                }\r\n                setInterval(function(){\r\n                    if(hashchange()){\r\n                        self._change()\r\n                    }\r\n                }, 100);\r\n                hashchange(true)\r\n            }\r\n            else{\r\n                Nui.win.on('hashchange', function(){\r\n                    self._change()\r\n                })\r\n            }\r\n        },\r\n        _$ready:null,\r\n        _$fn:null,\r\n        init:null,\r\n        start:function(){\r\n            if(!this._initialize){\r\n                this._change();\r\n            }\r\n        },\r\n        location:function(url, data, render){\r\n            var self = this;\r\n            if(url){\r\n                if(arguments.length <=2 && typeof data === 'boolean'){\r\n                    render = data;\r\n                    data = null;\r\n                }\r\n                var temp, _router;\r\n                url = this._replace(url);\r\n                Nui.each(this._paths, function(val, rule){\r\n                    if(rule === url || (url.indexOf(val.path) === 0 &&\r\n                                        (temp = url.replace(val.path+'/', '')) && \r\n                                        temp.split('/').length === val.params.length)){\r\n                        _router = self.__instances[val.id];\r\n                        return false\r\n                    }\r\n                })\r\n                if(_router){\r\n                    _router._send = {\r\n                        data:data\r\n                    }\r\n                    _router._isRrender = render;\r\n                    _router._render(url)\r\n                }\r\n            }\r\n            else{\r\n                self.start()\r\n            }\r\n        },\r\n        forward:function(index){\r\n            history.forward(index);\r\n            return false\r\n        },\r\n        back:function(index){\r\n            history.back(index);\r\n            return false\r\n        }\r\n    }\r\n\r\n    if(Nui.bsie7){\r\n        statics._history = [];\r\n        statics._setHistory = function(hash){\r\n            if(!this._isHistory){\r\n                Nui.each(this._history, function(val){\r\n                    val.active = false\r\n                });\r\n                this._history.push({\r\n                    hash:hash,\r\n                    active:true\r\n                })\r\n            }\r\n            this._isHistory = false;\r\n        },\r\n        Nui.each(['forward', 'back'], function(v){\r\n            var value = v==='forward' ? 1 : -1;\r\n            statics[v] = function(){\r\n                var self = this, len = self._history.length;\r\n                statics._isHistory = true;\r\n                Nui.each(self._history, function(val, i){\r\n                    var index = i + value;\r\n                    if(val.active){\r\n                        //历史记录在起始或者末尾时，调用原生的记录\r\n                        if(index === -1 || index === len){\r\n                            window.history[v]();\r\n                            return false\r\n                        }\r\n                        var _history = self._history[index];\r\n                        if(_history){\r\n                            location.hash = _history.hash;\r\n                            _history.active = true;\r\n                        }\r\n                        val.active = false;\r\n                        return false\r\n                    }\r\n                })\r\n                return false\r\n            }\r\n        })\r\n    }\r\n\r\n    return this.extend(component, {\r\n        static:statics,\r\n        options:{\r\n            path:'',\r\n            template:'',\r\n            container:null,\r\n            data:{},\r\n            entry:false,\r\n            wrapper:false,\r\n            level:1,\r\n            onBefore:null,\r\n            onChange:null,\r\n            onData:null,\r\n            onInit:null,\r\n            onAfter:null\r\n        },\r\n        _init:function(){\r\n            var self = this, router = self.constructor;\r\n            if(self._exec() && !router._bind){\r\n                router._bind = true;\r\n                router._bindHashchange();\r\n            }\r\n        },\r\n        _exec:function(){\r\n            var self = this, opts = self.options, router = self.constructor;\r\n            self.container = router._jquery(opts.container);\r\n            if(opts.path && self.container){\r\n                self.path = router._replace(opts.path);\r\n                var paths = self._getpath();\r\n                var len = paths.params.length;\r\n                if((!len && opts.level === 1) || opts.level !== 1){\r\n                    router._setpaths(paths.rule, paths)\r\n                }\r\n                if(len && opts.level > 0){\r\n                    var params = [], split = '/:', param, sub;\r\n                    while(param = paths.params.shift()){\r\n                        params.push(param);\r\n                        sub = params.join(split);\r\n                        router._setpaths(paths.rule+split+sub, $.extend({}, paths, {\r\n                            params:sub.split(split)\r\n                        }))\r\n                    }\r\n                }\r\n                if(self._getTarget()){\r\n                    return self._event()\r\n                }\r\n            }\r\n        },\r\n        _getpath:function(){\r\n            var self = this, path = self.path, opts = self.options, index = path.indexOf('/:');\r\n            var paths = {\r\n                id:self.__id,\r\n                params:[],\r\n                rule:path,\r\n                path:path\r\n            }\r\n            if(index !== -1){\r\n                paths.params = path.substr(index+2).split('/:');\r\n                paths.path = path.substr(0, index);\r\n                if(opts.level > 0){\r\n                    paths.rule = paths.path;\r\n                }\r\n            }\r\n            return paths\r\n        },\r\n        _render:function(url){\r\n            var self = this, opts = self.options, href = url instanceof jQuery ? url.attr('href') : url;\r\n            if(href){\r\n                var trigger = false;\r\n                var change = function(){\r\n                    trigger = true;\r\n                    location.hash = '#!'+self.constructor._replace(href)\r\n                }\r\n                if(typeof opts.onBefore === 'function' && opts.onBefore.call(opts, change) === false){\r\n                    return false\r\n                }\r\n                if(!trigger){\r\n                    change()\r\n                }\r\n            }\r\n        },\r\n        _event:function(){\r\n            var self = this, opts = self.options;\r\n            self._on('click', Nui.doc, self.target, function(e, elem){\r\n                self._render(elem);\r\n                return false\r\n            })\r\n            return self\r\n        },\r\n        _reset:function(){\r\n            var self = this, router = self.constructor;\r\n            self._off();\r\n            Nui.each(router._paths, function(val, i){\r\n                if(val.id === self.__id){\r\n                    delete router._paths[i];\r\n                }\r\n            })\r\n            return self\r\n        },\r\n        option:null,\r\n        reset:null\r\n    })\r\n})\nNui.define('./script/demo',['src/components/router'], function(router){\r\n    \r\n\trouter({\r\n\t\ttarget:'#home',\r\n\t\tentry:true,\r\n\t\tpath:'/home/', \r\n\t\tcontainer:'#main',\r\n\t\ttemplate:'<div>这是首页</div>'\r\n\t})\r\n\r\n\trouter({\r\n\t\ttarget:'#news',\r\n\t\tpath:'/news/',\r\n\t\tcontainer:'#main',\r\n\t\ttemplate:'<div>这是资讯页</div>'\r\n\t})\r\n\r\n\trouter.start()\r\n})\n"]}