{"version":3,"sources":["base-debug.js"],"names":["Nui","define","this","extend","static","_init","self","doc","on","_active","each","__instances","val","element","find","removeClass","_getcode","type","text","_getarr","match","code","array","v","index","indexOf","sub","substr","length","push","_comment","test","replace","options","tools","copy","isLight","isLine","isTitle","_exec","target","_getTarget","dom","get","tagName","html","remove","_create","_event","_title","_template","_events","click tr","e","elem","constructor","addClass","siblings","stopPropagation","click .copy","alert","opts","data","$","bsie7","list","_list","title","_tplData","_tpl2html","insertAfter","_getCode","split","_class","str","trim","RegExp","js","css","res","v1","v2","k2","istag","preBlank","tagname","toLowerCase","exports","call","xml","imports","hash","location","main","items","menus","init","setYear","event","position","Date","getFullYear","scrollTop","top","scroll","stop","i","item","id","itop","ntop","next","eq","outerHeight","removeAttr","attr","box","height","timer","resize","win","clearTimeout","setTimeout"],"mappings":"AAOAA,IAAIC,OAAO,qCAAqC,WAC5C,MAAOC,MAAKC,OAAO,aACfC,QACIC,MAAM,WACF,GAAIC,GAAOJ,IACXF,KAAIO,IAAIC,GAAG,QAAS,WACbF,EAAKG,SACJT,IAAIU,KAAKJ,EAAKK,YAAa,SAASC,GAC7BA,EAAIH,UACHG,EAAIC,QAAQC,KAAK,YAAYC,YAAY,SACzCH,EAAIH,SAAU,KAI1BH,EAAKG,SAAU,KAGvBO,SAAS,SAASC,EAAMC,GACpB,MAAO,gBAAiBD,EAAM,KAAMC,EAAM,WAE9CC,QAAQ,SAASC,EAAOC,GACpB,GAAIC,KAcJ,OAbIF,IAIApB,IAAIU,KAAKU,EAAO,SAASG,GACrB,GAAIC,GAAQH,EAAKI,QAAQF,GACrBG,EAAML,EAAKM,OAAO,EAAGH,EACzBH,GAAOA,EAAKM,OAAOH,EAAMD,EAAEK,QAC3BN,EAAMO,KAAKH,GACXJ,EAAMO,KAAKN,KAEfD,EAAMO,KAAKR,IAVXC,EAAMO,KAAKR,GAYRC,GAEXQ,SAAS,SAAST,GASd,MAPG,OAAOU,KAAKV,GACXA,EAAOA,EAAKW,QAAQ,sBAAuB9B,KAAKc,SAAS,UAAW,OAGhE,OAAOe,KAAKV,KAChBA,EAAOA,EAAKW,QAAQ,aAAc9B,KAAKc,SAAS,UAAW,QAExDK,IAGfY,SAEIC,OAEIC,MAAK,GAGTC,SAAQ,EAERC,QAAO,EAEPC,SAAQ,GAEZjC,MAAM,WACFH,KAAKqC,SAETA,MAAM,WACF,GAAIjC,GAAOJ,KAAMsC,EAASlC,EAAKmC,YAC/B,IAAGD,EAAO,CACN,GAAIE,GAAMF,EAAOG,IAAI,EACF,YAAhBD,EAAIE,SAAoC,kBAAZF,EAAIzB,OAC/BX,EAAKe,KAAOmB,EAAOK,OACNb,QAAQ,qBAAsB,IAC9BA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACxB1B,EAAKO,SACJP,EAAKO,QAAQiC,SAEjBxC,EAAKyC,UACFzC,EAAK2B,QAAQG,SACZ9B,EAAK0C,YAKrBC,OAAO,GACPC,UACI,oYAsBJC,SACIC,WAAW,SAASC,EAAGC,GACnBpD,KAAKqD,YAAY9C,QAAUP,KAAKO,SAAU,EAC1C6C,EAAKE,SAAS,SAASC,WAAW1C,YAAY,SAC9CsC,EAAEK,mBAENC,cAAc,WACVC,MAAM,cAGdb,QAAQ,WACJ,GAAIzC,GAAOJ,KACP2D,EAAOvD,EAAK2B,QACZ6B,EAAOC,EAAE5D,QACT6D,MAAMhE,IAAIgE,MACVC,KAAK3D,EAAK4D,QACVC,MAAM7D,EAAK2C,OACXZ,OAAOwB,EAAKxB,OACZH,MAAM2B,EAAK3B,MACXI,QAAQuB,EAAKvB,SACdhC,EAAK8D,WACR9D,GAAKO,QAAUkD,EAAEzD,EAAK+D,UAAUP,IAAOQ,YAAYhE,EAAKkC,SAE5D+B,SAAS,WACL,MAAOrE,MAAKmB,MAEhB6C,MAAM,WACF,MAAOhE,MAAKqE,WAAWC,MAAM,WAYzCxE,IAAIC,OAAO,iCAAiC,WACxC,MAAOC,MAAKC,OAAO,sCACf8C,OAAO,MACPsB,SAAS,WACL,GAAIjE,GAAOJ,KACPmB,EAAOf,EAAKe,KACZoD,EAASnE,EAAKiD,YACdmB,EAAM,GACNtD,EAAQC,EAAKD,MAAM,wCACnBE,EAAQmD,EAAOtD,QAAQC,EAAOC,EAsBlC,OArBArB,KAAIU,KAAKY,EAAO,SAASC,GAClBvB,IAAI2E,KAAKpD,KAGJA,EADD,WAAWQ,KAAKR,GACXA,EAAES,QAAQ,QAASyC,EAAOzD,SAAS,UAAW,OAI/C,SAASe,KAAKR,GACTA,EAAES,QAAQ,4CAA6C,KAAKyC,EAAOzD,SAAS,OAAQ,MAAM,KAAKyD,EAAOzD,SAAS,SAAU,OACxHgB,QAAQ,gBAAiByC,EAAOzD,SAAS,SAAU,OAIpDO,EAAES,QAAQ,wBAAyByC,EAAOzD,SAAS,WAAY,OAC9DgB,QAAQ,oBAAqByC,EAAOzD,SAAS,SAAU,QAIxE0D,GAAOnD,IAEJmD,OAYnB1E,IAAIC,OAAO,sCAAsC,WAC7C,MAAOC,MAAKC,OAAO,sCACf8C,OAAO,KACPsB,SAAS,WACL,GAAIjE,GAAOJ,KACPmB,EAAOf,EAAKe,KACZoD,EAASnE,EAAKiD,YACdmB,EAAM,GAKNtD,EAAQC,EAAKD,MAAM,oDACnBE,EAAQmD,EAAOtD,QAAQC,EAAOC,EA6BlC,OA5BArB,KAAIU,KAAKY,EAAO,SAASC,GAClBwC,EAAEY,KAAKpD,KAEH,WAAWQ,KAAKR,GACfA,EAAIkD,EAAOzD,SAAS,UAAWO,GAG3B,WAAWQ,KAAKR,GACpBA,EAAIA,EAAES,QAAQ,QAASyC,EAAOzD,SAAS,UAAW,QAK9CO,EADD,MAAMQ,KAAKR,GACNA,EAAES,QAAQ,QAASyC,EAAOzD,SAAS,SAAU,OAI7CO,EAAES,QAAQ,GAAI4C,QAAO,mFAAkB,KAAMH,EAAOzD,SAAS,SAAU,OACtEgB,QAAQ,GAAI4C,QAAO,saAA8B,KAAMH,EAAOzD,SAAS,UAAW,MAAM,MACxFgB,QAAQ,qBAAsB,KAAKyC,EAAOzD,SAAS,SAAU,OAC7DgB,QAAQ,qCAAsC,KAAKyC,EAAOzD,SAAS,OAAQ,MAAM,MAG1FO,EAAIkD,EAAO3C,SAASP,KAG5BmD,GAAOnD,IAEJmD,OAYnB1E,IAAIC,OAAO,gCAAgC,sCAAuC,kCAAkC,SAAS4E,EAAIC,GAC7H,MAAO5E,MAAKC,OAAO,sCACf8C,OAAO,MACPsB,SAAS,WACL,GAAIjE,GAAOJ,KACPmB,EAAOf,EAAKe,KACZoD,EAASnE,EAAKiD,YACdmB,EAAM,EA4DV,OA3DArD,GAAOA,EAAKW,QAAQ,yBAA0B,SAAS+C,GACnD,MAAOA,GAAI/C,QAAQ,QAAS,MAAMA,QAAQ,QAAS,QAEvDhC,IAAIU,KAAKW,EAAKmD,MAAM,QAAS,SAASQ,GAClCA,EAAKA,EAAGR,MAAM,OACd,IAAI5C,GAASoD,EAAGpD,MAChB5B,KAAIU,KAAKsE,EAAI,SAASC,EAAIC,GACtB,GAAGlF,IAAI2E,KAAKM,GAAI,CACZ,GAAS,GAANC,EAAQ,CACP,GAAIC,IAAQ,CACZ,IAAG,SAASpD,KAAKkD,GACbA,EAAKA,EAAGjD,QAAQ,gBAAiByC,EAAOzD,SAAS,MAAO,OAChDgB,QAAQ,YAAayC,EAAOzD,SAAS,SAAU,WAEvD,CACA,GAAIoE,GAAWH,EAAG7D,MAAM,SAAS,EAC9B,cAAaW,KAAKkD,KACjBE,GAAQ,GAEZF,EAAKA,EAAGjD,QAAQ,OAAQ,IAChBA,QAAQ,qDAAsD,KAAKyC,EAAOzD,SAAS,OAAQ,MAAMyD,EAAOzD,SAAS,SAAU,MAAMyD,EAAOzD,SAAS,SAAU,OAC3JgB,QAAQ,+DAAgE,MACxEA,QAAQ,YAAayC,EAAOzD,SAAS,MAAO,OAC5CgB,QAAQ,YAAayC,EAAOzD,SAAS,SAAU,OACvDiE,EAAKG,EAAWH,EAEpBA,EAAKR,EAAOzD,SAAS,SAAU,QAAUiE,EACrCE,IACAF,GAAMR,EAAOzD,SAAS,SAAU,aAKpC,IAAc,IAAXY,GAAuB,IAAPsD,GAAY,aAAanD,KAAKkD,GAC7CA,EAAKA,EAAGjD,QAAQ,eAAgByC,EAAOzD,SAAS,SAAU,OAASyD,EAAOzD,SAAS,SAAU,YAG7F,CACA,GAAIqE,GAAUtB,EAAEY,KAAKK,EAAG,IAAIM,aAExBL,GADU,SAAXI,EACMP,EAAIS,QAAQhB,SAASiB,KAAKlF,EAAM2E,GAEtB,UAAXI,EACCR,EAAGU,QAAQhB,SAASiB,KAAKlF,EAAM2E,GAG/BA,EAAGjD,QAAQ,QAASyC,EAAOzD,SAAS,OAAQ,OAK7DiE,EAAKA,EAAGjD,QAAQ,qBAAsB,SAAS+C,GAC3C,MAAOA,GAAI/C,QAAQ,cAAeyC,EAAOzD,SAAS,UAAW,OAAOgB,QAAQ,MAAO,QAAQA,QAAQ,MAAO,UAGlH0C,GAAOO,MAIRP,OAKnB1E,IAAIC,OAAO,iBAAiB,gCAAiC,SAASwF,GAClEvF,KAAKwF,QAAQ,gBACb,IAAIC,GAAOC,SAASD,KAAK3D,QAAQ,IAAK,IAClC6D,EAAO9B,EAAE,WACT+B,EAAQD,EAAK/E,KAAK,MAElBiF,GADSD,EAAMlE,OACPmC,EAAE,cAEd,QACIiC,KAAK,WACD9F,KAAK+F,UACFJ,EAAK/E,KAAK,UAAUc,SACnB1B,KAAKgG,QACLhG,KAAKiG,YAENnG,IAAIgE,OACH9D,KAAK8D,SAGbiC,QAAQ,WACJlC,EAAE,YAAY7C,KAAK,KAAI,GAAIkF,OAAOC,gBAEtCF,SAAS,WACL,GAAGR,EAAK,CACJ,GAAIrC,GAAOS,EAAE,QAAS4B,EAAM,KAC5BrC,GAAK1B,QAAUiE,EAAKS,UAAUhD,EAAK6C,WAAWI,OAGtDL,MAAM,WACFL,EAAKW,OAAO,WACR,GAAIC,GAAOZ,EAAKS,WAChBR,GAAMpF,KAAK,SAASgG,GAChB,GAAIC,GAAO5C,EAAE7D,MACT0G,EAAK1G,KAAK0G,GACVC,EAAOF,EAAKR,WAAWI,IAAM,GAC7BO,EAAO,EACPC,EAAOjB,EAAMkB,GAAGN,EAAE,EAQtB,IANII,EADDC,EAAKnF,OACGmF,EAAKZ,WAAWI,IAAM,GAGtBxC,EAAE,YAAYkD,cAEzBlB,EAAMjF,KAAK,WAAWC,YAAY,SAC/B0F,GAAQI,GAAQJ,EAAOK,EAMtB,MALAf,GAAMjF,KAAK,YAAa8F,EAAI,MAAMpD,SAAS,SAE3CmD,EAAKO,WAAW,MAChBtB,SAASD,KAAOiB,EAChBD,EAAKQ,KAAK,KAAMP,IACT,OAKvB5C,MAAM,WACF,GAAIoD,GAAMrD,EAAE,sBACRsD,EAAStD,EAAE,aAAakD,cACxBK,EAAQ,KACRC,EAAS,WACTH,EAAIC,OAAOrH,IAAIwH,IAAIH,SAAWA,GAElCrH,KAAIwH,IAAID,OAAO,WACXE,aAAaH,GACbA,EAAQI,WAAWH,EAAQ,OAE/BA","file":"base-min.js.map?v=393941f","sourcesContent":["/**\r\n * @author Aniu[2017-03-02 08:44]\r\n * @update Aniu[2017-03-02 08:44]\r\n * @version 1.0.1\r\n * @description 语法高亮组件\r\n */\r\n\r\nNui.define('src/components/highlight/highlight',function(){\r\n    return this.extend('component', {\r\n        static:{\r\n            _init:function(){\r\n                var self = this;\r\n                Nui.doc.on('click', function(){\r\n                    if(self._active){\r\n                        Nui.each(self.__instances, function(val){\r\n                            if(val._active){\r\n                                val.element.find('tr.s-crt').removeClass('s-crt');\r\n                                val._active = false;\r\n                            }\r\n                        })\r\n                    }\r\n                    self._active = false;\r\n                })\r\n            },\r\n            _getcode:function(type, text){\r\n                return '<code class=\"'+ type +'\">'+ text +'</code>'\r\n            },\r\n            _getarr:function(match, code){\r\n                var array = [];\r\n                if(!match){\r\n                    array.push(code)\r\n                }\r\n                else{\r\n                    Nui.each(match, function(v){\r\n                        var index = code.indexOf(v);\r\n                        var sub = code.substr(0, index);\r\n                        code = code.substr(index+v.length);\r\n                        array.push(sub);\r\n                        array.push(v);\r\n                    })\r\n                    array.push(code);\r\n                }\r\n                return array\r\n            },\r\n            _comment:function(code){\r\n                //多行注释\r\n                if(/\\/\\*/.test(code)){\r\n                    code = code.replace(/(\\/\\*(.|\\s)*?\\*\\/)/g, this._getcode('comment', '$1'))\r\n                }\r\n                //单行注释\r\n                else if(/\\/\\//.test(code)){\r\n                    code = code.replace(/(\\/\\/.*)$/g, this._getcode('comment', '$1'))\r\n                }\r\n                return code\r\n            }\r\n        },\r\n        options:{\r\n            //工具栏\r\n            tools:{\r\n                //复制\r\n                copy:true\r\n            },\r\n            //点击代码那一行高亮\r\n            isLight:true,\r\n            //是否显示行号\r\n            isLine:false,\r\n            //是否显示语法标题\r\n            isTitle:true\r\n        },\r\n        _init:function(){\r\n            this._exec();\r\n        },\r\n        _exec:function(){\r\n            var self = this, target = self._getTarget();\r\n            if(target){\r\n                var dom = target.get(0);\r\n                if(dom.tagName === 'SCRIPT' && dom.type == 'text/highlight'){\r\n                    self.code = target.html()\r\n                                .replace(/^[\\r\\n]+|[\\r\\n]+$/g, '')\r\n                                .replace(/</g, '&lt;')\r\n                                .replace(/>/g, '&gt;');\r\n                    if(self.element){\r\n                        self.element.remove();\r\n                    }\r\n                    self._create();\r\n                    if(self.options.isLight){\r\n                        self._event();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _title:'',\r\n        _template:\r\n            '<div class=\"<% className %>\">'\r\n                +'<%if tools%>'\r\n                +'<div class=\"tools\">'\r\n                    +'<%if tools.copy%>'\r\n                    +'<em class=\"copy\">复制</em>'\r\n                    +'<%/if%>'\r\n                +'</div>'\r\n                +'<%/if%>'\r\n                +'<div class=\"body\">'\r\n                    +'<table>'\r\n                        +'<%each list val key%>'\r\n                            +'<tr>'\r\n                                +'<%if isLine === true%><td class=\"line\" number=\"<%key+1%>\"><%if bsie7%><%key+1%><%/if%></td><%/if%>'\r\n                                +'<td class=\"code\"><%val%></td>'\r\n                            +'</tr>'\r\n                        +'<%/each%>'\r\n                    +'</table>'\r\n                +'</div>'\r\n                +'<%if isTitle%>'\r\n                +'<em class=\"title\"><%title%></em>'\r\n                +'<%/if%>'\r\n            +'</div>',\r\n        _events:{\r\n            'click tr':function(e, elem){\r\n                this.constructor._active = this._active = true;\r\n                elem.addClass('s-crt').siblings().removeClass('s-crt');\r\n                e.stopPropagation()\r\n            },\r\n            'click .copy':function(){\r\n                alert('傻帽！逗你玩呢。')\r\n            }\r\n        },\r\n        _create:function(){\r\n            var self = this;\r\n            var opts = self.options;\r\n            var data = $.extend({\r\n                bsie7:Nui.bsie7,\r\n                list:self._list(),\r\n                title:self._title,\r\n                isLine:opts.isLine,\r\n                tools:opts.tools,\r\n                isTitle:opts.isTitle\r\n            }, self._tplData())\r\n            self.element = $(self._tpl2html(data)).insertAfter(self.target);\r\n        },\r\n        _getCode:function(){\r\n            return this.code\r\n        },\r\n        _list:function(){\r\n            return this._getCode().split('\\n')\r\n        }\r\n    })\r\n})\r\n\n/**\r\n * @author Aniu[2017-03-02 08:44]\r\n * @update Aniu[2017-03-02 08:44]\r\n * @version 1.0.1\r\n * @description css语法高亮组件\r\n */\r\n\r\nNui.define('src/components/highlight/style',function(){\r\n    return this.extend('src/components/highlight/highlight', {\r\n        _title:'css',\r\n        _getCode:function(){\r\n            var self = this;\r\n            var code = self.code;\r\n            var _class = self.constructor;\r\n            var str = '';\r\n            var match = code.match(/(\\/\\*(.|\\s)*?\\*\\/)|(\\{[^\\{\\}\\/]*\\})/g);\r\n            var array = _class._getarr(match, code);\r\n            Nui.each(array, function(v){\r\n                if(Nui.trim(v)){\r\n                    //多行注释\r\n                    if(/^\\s*\\/\\*/.test(v)){\r\n                        v = v.replace(/(.+)/g, _class._getcode('comment', '$1'))\r\n                    }\r\n                    else{\r\n                        //匹配属性\r\n                        if(/\\}\\s*$/.test(v)){\r\n                            v = v.replace(/(\\s*)([^:;\\{\\}\\/\\*]+)(:)([^:;\\{\\}\\/\\*]+)/g, '$1'+_class._getcode('attr', '$2')+'$3'+_class._getcode('string', '$4'))\r\n                                .replace(/([\\:\\;\\{\\}])/g, _class._getcode('symbol', '$1'));\r\n                        }\r\n                        //选择器\r\n                        else{\r\n                            v = v.replace(/([^\\:\\{\\}\\@\\#\\s\\.]+)/g, _class._getcode('selector', '$1'))\r\n                                .replace(/([\\:\\{\\}\\@\\#\\.])/g, _class._getcode('symbol', '$1'));\r\n                        }\r\n                    }\r\n                }\r\n                str += v;\r\n            })\r\n            return str\r\n        }\r\n    })\r\n})\r\n\n/**\r\n * @author Aniu[2017-03-02 08:44]\r\n * @update Aniu[2017-03-02 08:44]\r\n * @version 1.0.1\r\n * @description javascript语法高亮组件\r\n */\r\n\r\nNui.define('src/components/highlight/javascript',function(){\r\n    return this.extend('src/components/highlight/highlight', {\r\n        _title:'js',\r\n        _getCode:function(){\r\n            var self = this;\r\n            var code = self.code;\r\n            var _class = self.constructor;\r\n            var str = '';\r\n            var kws = 'abstract|arguments|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|elseif|each|enum|eval|export|'+\r\n                      'extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|include|interface|let|long|native|new|null|'+\r\n                      'package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var';\r\n            var symbol = '&lt;|&gt;|;|!|%|\\\\\\|\\\\\\[|\\\\\\]|\\\\\\(|\\\\\\)|\\\\\\{|\\\\\\}|\\\\\\=|\\\\\\/|-|\\\\\\+|,|\\\\\\.|\\\\\\:|\\\\\\?|~|\\\\\\*|&';\r\n            var match = code.match(/(\\/\\/.*)|(\\/\\*(.|\\s)*?\\*\\/)|('[^']*')|(\"[^\"]*\")/g);\r\n            var array = _class._getarr(match, code);\r\n            Nui.each(array, function(v){\r\n                if($.trim(v)){\r\n                    //单行注释\r\n                    if(/^\\s*\\/\\//.test(v)){\r\n                        v = _class._getcode('comment', v);\r\n                    }\r\n                    //多行注释\r\n                    else if(/^\\s*\\/\\*/.test(v)){\r\n                        v = v.replace(/(.+)/g, _class._getcode('comment', '$1'))\r\n                    }\r\n                    else{\r\n                        //字符串\r\n                        if(/'|\"/.test(v)){\r\n                            v = v.replace(/(.+)/g, _class._getcode('string', '$1'))\r\n                        }\r\n                        //关键字、符号、单词\r\n                        else{\r\n                            v = v.replace(new RegExp('('+ symbol +')', 'g'), _class._getcode('symbol', '$1'))\r\n                                .replace(new RegExp('('+ kws +')(\\\\s+|\\\\\\<code)', 'g'), _class._getcode('keyword', '$1')+'$2')\r\n                                .replace(/(\\/code>\\s*)(\\d+)/g, '$1'+_class._getcode('number', '$2'))\r\n                                .replace(/(\\/code>\\s*)?([^<>\\s]+)(\\s*<code)/g, '$1'+_class._getcode('word', '$2')+'$3')\r\n\r\n                        }\r\n                        v = _class._comment(v);\r\n                    }\r\n                }\r\n                str += v;\r\n            })\r\n            return str\r\n        }\r\n    })\r\n})\r\n\n/**\r\n * @author Aniu[2017-03-02 08:44]\r\n * @update Aniu[2017-03-02 08:44]\r\n * @version 1.0.1\r\n * @description xml语法高亮组件\r\n */\r\n\r\nNui.define('src/components/highlight/xml',['src/components/highlight/javascript', 'src/components/highlight/style'],function(js, css){\r\n    return this.extend('src/components/highlight/highlight', {\r\n        _title:'xml',\r\n        _getCode:function(){\r\n            var self = this;\r\n            var code = self.code;\r\n            var _class = self.constructor;\r\n            var str = '';\r\n            code = code.replace(/&lt;\\s*![^!]+-\\s*&gt;/g, function(res){\r\n                return res.replace(/&lt;/g, '<<').replace(/&gt;/g, '>>')\r\n            });\r\n            Nui.each(code.split('&lt;'), function(v1){\r\n                v1 = v1.split('&gt;');\r\n                var length = v1.length;\r\n                Nui.each(v1, function(v2, k2){\r\n                    if(Nui.trim(v2)){\r\n                        if(k2 == 0){\r\n                            var istag = false;\r\n                            if(/^\\s*\\//.test(v2)){\r\n                                v2 = v2.replace(/([^\\r\\n\\/]+)/g, _class._getcode('tag', '$1'))\r\n                                       .replace(/^(\\s*\\/+)/, _class._getcode('symbol', '$1'))\r\n                            }\r\n                            else{\r\n                                var preBlank = v2.match(/^\\s+/)||'';\r\n                                if(/\\=\\s*['\"]$/.test(v2)){\r\n                                    istag = true\r\n                                }\r\n                                v2 = v2.replace(/^\\s+/, '')\r\n                                       .replace(/(\\s+)([^'\"\\/\\s\\=]+)((\\s*=\\s*)(['\"]?[^'\"]*['\"]?))?/g, '$1'+_class._getcode('attr', '$2')+_class._getcode('symbol', '$4')+_class._getcode('string', '$5'))\r\n                                       .replace(/<code class=\"\\w+\">(\\s*((<<\\s*![-\\s]+)|([-\\s]+>>))?)<\\/code>/g, '$1')\r\n                                       .replace(/^([^\\s]+)/, _class._getcode('tag', '$1'))\r\n                                       .replace(/(\\/+\\s*)$/, _class._getcode('symbol', '$1'))\r\n                                v2 = preBlank + v2;\r\n                            }\r\n                            v2 = _class._getcode('symbol', '&lt;') + v2;\r\n                            if(!istag){\r\n                                v2 += _class._getcode('symbol', '&gt;');\r\n                            }\r\n                        }\r\n                        else{\r\n                            //闭合标签\r\n                            if(length === 3 && k2 === 1 && /\\s*['\"]\\s*/.test(v2)){\r\n                                v2 = v2.replace(/(\\s*['\"]\\s*)/, _class._getcode('symbol', '$1')) + _class._getcode('symbol', '&gt;');\r\n                            }\r\n                            //内容\r\n                            else{\r\n                                var tagname = $.trim(v1[0]).toLowerCase();\r\n                                if(tagname == 'style'){\r\n                                    v2 = css.exports._getCode.call(self, v2)\r\n                                }\r\n                                else if(tagname == 'script'){\r\n                                    v2 = js.exports._getCode.call(self, v2)\r\n                                }\r\n                                else{\r\n                                    v2 = v2.replace(/(.+)/g, _class._getcode('text', '$1'))\r\n                                }\r\n                            }\r\n                        }\r\n                        //注释\r\n                        v2 = v2.replace(/<<\\s*![^!]+-\\s*>>/g, function(res){\r\n                            return res.replace(/([^\\r\\n]+)/g, _class._getcode('comment', '$1')).replace(/<</g, '&lt;').replace(/>>/g, '&gt;')\r\n                        })\r\n                    }\r\n                    str += v2\r\n                })\r\n            })\r\n\r\n            return str\r\n        }\r\n    })\r\n})\r\n\nNui.define('{script}/base',['src/components/highlight/xml'], function(xml){\r\n    this.imports('../style/base');\r\n    var hash = location.hash.replace('#', '');\r\n    var main = $('.g-main');\r\n    var items = main.find('h2');\r\n    var length = items.length;\r\n    var menus = $('.m-menu ul');\r\n\r\n    return ({\r\n        init:function(){\r\n            this.setYear();\r\n            if(main.find('h2[id]').length){\r\n                this.event();\r\n                this.position();\r\n            }\r\n            if(Nui.bsie7){\r\n                this.bsie7();\r\n            }\r\n        },\r\n        setYear:function(){\r\n            $('#nowyear').text('-'+new Date().getFullYear());\r\n        },\r\n        position:function(){\r\n            if(hash){\r\n                var elem = $('[id=\"'+ hash +'\"]');\r\n                elem.length && main.scrollTop(elem.position().top)\r\n            }\r\n        },\r\n        event:function(){\r\n            main.scroll(function(){\r\n                var stop = main.scrollTop();\r\n                items.each(function(i){\r\n                    var item = $(this);\r\n                    var id = this.id;\r\n                    var itop = item.position().top - 20;\r\n                    var ntop = 0;\r\n                    var next = items.eq(i+1);\r\n                    if(next.length){\r\n                        ntop = next.position().top - 20\r\n                    }\r\n                    else{\r\n                        ntop = $('.mainbox').outerHeight()\r\n                    }\r\n                    menus.find('a.s-crt').removeClass('s-crt');\r\n                    if(stop >= itop && stop < ntop){\r\n                        menus.find('a[href=\"#'+ id +'\"]').addClass('s-crt');\r\n                        //为了阻止设置location.hash时，浏览器会自行定位到该id的起始位置\r\n                        item.removeAttr('id');\r\n                        location.hash = id;\r\n                        item.attr('id', id);\r\n                        return false;\r\n                    }\r\n                })\r\n            })\r\n        },\r\n        bsie7:function(){\r\n            var box = $('.g-html .g-content');\r\n            var height = $('.g-header').outerHeight();\r\n            var timer = null;\r\n            var resize = function(){\r\n                box.height(Nui.win.height() - height)\r\n            }\r\n            Nui.win.resize(function(){\r\n                clearTimeout(timer);\r\n                timer = setTimeout(resize, 100)\r\n            })\r\n            resize();\r\n        }\r\n    })\r\n})\r\n\n"]}